
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The DS1307 Serial Real-Time Clock is a low-power, full binary-coded decimal (BCD) clock/calendar plus 56 bytes of NV SRAM. Address and data are transferred serially via a 2-wire, bi-directional bus. The clock/calendar provides seconds, minutes, hours, day, date, month, and year information.">
      
      
      
      
      <link rel="icon" href="https://cdn.steminds.com/docs/images/icon.svg">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>STEMinds - DS1307Z Real time clock (RTC) Module - STEMinds Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../stylesheets/style-starter.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-165700957-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="default" data-md-color-accent="amber">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ds1307z-rtc-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <!--
  Copyright (c) 2016-2020 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Mitigate bug: https://github.com/mkdocs/mkdocs/issues/2191 -->



<!-- Application header -->
<header class="w3l-bootstrap-header" data-md-component="header">
    <nav class="navbar navbar-expand-lg navbar-dark py-lg-2 py-2">
      <div class="container">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <!-- Button to open drawer -->
          <label class="md-header-nav__button md-icon" for="__drawer">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
          </label>
        </button>

        <a class="navbar-brand" href="#index.html" style="color: #FFC51D;">
            <img src="https://cdn.steminds.com/docs/images/icon.svg" alt="STEMinds" title="STEMinds" style="height:48px;" />
            STEMinds
        </a>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mx-auto">
            <li class="nav-item">
              <a class="nav-link" href="https://steminds.com/">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://shop.steminds.com/">Products</a>
            </li>
              <li class="nav-item">
              <a class="nav-link" href="https://wiki.steminds.com/">Documentation</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://steminds.com/contact.html">Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="STEMinds Documentation" class="md-nav__button md-logo" aria-label="STEMinds Documentation" data-md-component="logo">
      
  <img src="https://cdn.steminds.com/docs/images/icon.svg" alt="logo">

    </a>
    STEMinds Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Products
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Products" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Products
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../products/eduponics_mini_extension_board/" class="md-nav__link">
        Extension board for Eduponics Mini
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Kits
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Kits" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Kits
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      <label class="md-nav__link" for="__nav_3_1">
        Eduponics Mini
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Eduponics Mini" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Eduponics Mini
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../eduponics_mini_getting_started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../advance_tools/" class="md-nav__link">
        Advance manual tools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bme280_temperature_and_humidity/" class="md-nav__link">
        BME280 sensor
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dht11_temperature_and_humidity/" class="md-nav__link">
        DHT11 sensor
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../light_sensor/" class="md-nav__link">
        BH1750 Light sensor
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../water_quantity_sensor/" class="md-nav__link">
        Water level sensor
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../pump/" class="md-nav__link">
        Water pump
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../rgb_led/" class="md-nav__link">
        RGB LED
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../eeprom_module/" class="md-nav__link">
        EEPROM Module
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          RTC Module
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        RTC Module
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#specifications" class="md-nav__link">
    Specifications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#possible-applications" class="md-nav__link">
    Possible applications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardware-explanation" class="md-nav__link">
    Hardware explanation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connecting-the-battery-to-the-rtc-module" class="md-nav__link">
    Connecting the battery to the RTC module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-explanation" class="md-nav__link">
    Software explanation
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../soil_moisture_sensor/" class="md-nav__link">
        Soil moisture sensor
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../deep_sleep_wakeup/" class="md-nav__link">
        Deep sleep wakeup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../advance_usage/RGB_indicators/" class="md-nav__link">
        RGB based indicators
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../advance_usage/water_level_based_water_pumping/" class="md-nav__link">
        Water level based pump
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../advance_usage/introduction_to_mqtt/" class="md-nav__link">
        Introduction to MQTT
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../advance_usage/basic_mqtt_client/" class="md-nav__link">
        Basic MQTT client
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../advance_usage/eduponics_mqtt_app/" class="md-nav__link">
        Eduponics MQTT APP
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#specifications" class="md-nav__link">
    Specifications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#possible-applications" class="md-nav__link">
    Possible applications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardware-explanation" class="md-nav__link">
    Hardware explanation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connecting-the-battery-to-the-rtc-module" class="md-nav__link">
    Connecting the battery to the RTC module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-explanation" class="md-nav__link">
    Software explanation
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="ds1307z-rtc-module">DS1307Z RTC Module</h1>
<p>The DS1307 Serial Real-Time Clock is a low-power, full binary-coded decimal (BCD) clock/calendar
plus 56 bytes of NV SRAM. Address and data are transferred serially via a 2-wire, bi-directional bus.
The clock/calendar provides seconds, minutes, hours, day, date, month, and year information. The end of
the month date is automatically adjusted for months with fewer than 31 days, including corrections for
leap year.
<br/><br/>
The clock operates in either the 24-hour or 12-hour format with AM/PM indicator. The
DS1307 has a built-in power sense circuit that detects power failures and automatically switches to the
battery supply.
<br/><br/>
While the ESP32 have a built-in RTC inside, the RTC inside of the ESP32 is mostly used for counting (like a timer) but what if we need to know the exact time of the day or the date when our ESP32 wakeup in order to figure out if it's time to do something? for this purpose we've added extra component - our DS1307Z RTC module.
<br/><br/>
The Internal ESP32 RTC can be connected to a battery but this coin battery will power the entire ESP32 board and not just the RTC functionality which will force the ESP32 to constantly be in sleep mode in order not to waste energy which is something unreasonable to do in case of our application.</p>
<div class="admonition warning">
<p class="admonition-title">RTC Lithium coin cell battery not included in Eduponics Mini kit.</p>
<p>Due to shipping regulations and policies we are not able to ship the lithium batteries inside the kit,
the RTC module requires the coin cell battery to operate and save data even when the ESP32 is off.</p>
</div>
<h2 id="specifications">Specifications</h2>
<p>The DS1307Z RTC includes bunch of useful features, such as:</p>
<ul>
<li>Real-time clock (RTC) counts seconds, minutes, hours, date of the month, month, day of the week, and year with leap-year</li>
<li>compensation valid up to 2100 56-byte, battery-backed, nonvolatile (NV)</li>
<li>RAM for data storage Two-wire serial interface</li>
<li>Programmable squarewave output signal</li>
<li>Automatic power-fail detect and switch circuitry</li>
<li>Consumes less than 500nA in battery backup mode with oscillator running</li>
</ul>
<p>For the complete data sheet check here: <a href="https://www.sparkfun.com/datasheets/Components/DS1307.pdf">DS1307 data sheet from sparkfun.com</a></p>
<h2 id="possible-applications">Possible applications</h2>
<p>The RTC module is super useful, here are some of the possible applications you can archive using it:</p>
<ul>
<li>Store data and time to refer to without wireless connectivity</li>
<li>Use the stored date and time to check if it's "time" to perform scheduled operation</li>
<li>Use time and date for logging, if something happens you will know when it did.</li>
<li>Any other application that require time or date to be pulled in no time.</li>
</ul>
<h2 id="hardware-explanation">Hardware explanation</h2>
<p align="center">
  <img src="https://cdn.steminds.com/docs/kits/eduponics_mini/RTC_ DS1307_schematic.jpg">
</p>

<p>The simple circuit the two inputs X1 and X2 are connected to a 32.768 kHz crystal oscillator as the source of the chip. VBAT is connected to positive culture of a 3V battery chip. VCC power to the I2C interface is 3.3V which is given by the ESP32 board. If the power supply VCC is not granted read and writes are inhibited.
<br/><br/>
CN1 represents the IO connections for the I2C interfae which we use to control the module and read/write from it.
<br/><br/>
On the Eduponics Mini board the RTC module and the crystal oscillator is at the front while the coin battery cell is mounted at the back.</p>
<h2 id="connecting-the-battery-to-the-rtc-module">Connecting the battery to the RTC module</h2>
<p align="center">
  <img src="https://cdn.steminds.com/docs/kits/eduponics_mini/3V-Coin-Cell-Battery-CR1220.jpg">
</p>

<p>The RTC coin battery is <b>not included</b> with the kit due to logistics concerns when shipping Lithium batteries, The battery type is CR1220 and can be found in probably any convenient shop near your home. The picture above is for illustration purpose only, there are many brands such as Panasonic, Murata, Cellewell etc ... all should work as long as it's 3V and same size (the model should be CR1220).</p>
<p align="center">
  <img src="https://cdn.steminds.com/docs/kits/eduponics_mini/eduponics_mini_plugging_rtc.png">
</p>

<p>The battery case can be found on the bottom side of the Eduponics Mini development board.
Make sure to plug the battery in the right direction (ground bottom side, positive side up).
<br/><br/>
Without the coin cell battery the RTC functionality will work but we won't be able to save any data after our device reboots or disconnect from power.</p>
<h2 id="software-explanation">Software explanation</h2>
<div class="admonition info">
<p class="admonition-title">Make sure micropython-eduponics is installed through upip</p>
<p>For our Python code, we will need to import eduponics library, make sure you followed the introduction guide on installing the library on the ESP32 Eduponics Mini board.</p>
</div>
<p>The software library is written by Mike Causer, you can check the Github library <a href="https://github.com/mcauser/micropython-tinyrtc">here</a>
<br/><br/>
The RTC communicates through I2C protocol that has multiple address for multiple functions such as halt (power on/off) register time and date and read data (control register).
<br/><br/>
First, we'll need to define the I2C device: The RTC connected to SCL IO PIN 15 and SDA IO PIN  4.
After we've configured that successfully we can call the .halt() function with the argument "False" which means don't halt the device or in other words - turn it on.
<br/><br/>
Then, we need to set the timestamp (current time and date for our device to remember) this can be done only once or if we need to change it later on to something different we can repeat it as many times as we want but that won't be necessary in most applications.
<br/><br/>
A good resource to get exact time and date would be <a href="https://www.epochconverter.com/">epochconverter.com</a> the last 2 zeroes in the time and date format can be left zeroed.
<br/><br/>
Finally, we can call .datetime() command to get the current time and date from the RTC module, it will update in real time even if we reboot or disconnect our device (as long as the coin battery lives)</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">MicroPython</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">MicroPython DS1307 RTC module</span>
<span class="sd">https://github.com/STEMinds/eduponics-mini</span>
<span class="sd">MIT License</span>
<span class="sd">Copyright (c) 2020 STEMinds</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights</span>
<span class="sd">to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="sd">copies of the Software, and to permit persons to whom the Software is</span>
<span class="sd">furnished to do so, subject to the following conditions:</span>
<span class="sd">The above copyright notice and this permission notice shall be included in all</span>
<span class="sd">copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="sd">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="sd">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="sd">OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="sd">SOFTWARE.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">from</span> <span class="nn">eduponics</span> <span class="kn">import</span> <span class="n">ds1307</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># configure i2c pin</span>
<span class="n">i2c</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">I2C</span><span class="p">(</span><span class="n">scl</span><span class="o">=</span><span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="n">sda</span><span class="o">=</span><span class="n">machine</span><span class="o">.</span><span class="n">Pin</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="c1"># configure the RTC using the i2c configuration</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds1307</span><span class="o">.</span><span class="n">DS1307</span><span class="p">(</span><span class="n">i2c</span><span class="p">)</span>
<span class="c1"># power on the chip</span>
<span class="n">ds</span><span class="o">.</span><span class="n">halt</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># set the current time (change it to the time you need)</span>
<span class="n">now</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># print current date and time</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">datetime</span><span class="p">())</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">ESP32-Arduino</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&quot;Wire.h&quot;</span><span class="cp"></span>
<span class="cp">#define DS3231_I2C_ADDRESS 0x68</span>
<span class="c1">// Convert normal decimal numbers to binary coded decimal</span>
<span class="n">byte</span> <span class="nf">decToBcd</span><span class="p">(</span><span class="n">byte</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span><span class="p">(</span> <span class="p">(</span><span class="n">val</span><span class="o">/</span><span class="mi">10</span><span class="o">*</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">val</span><span class="o">%</span><span class="mi">10</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
<span class="c1">// Convert binary coded decimal to normal decimal numbers</span>
<span class="n">byte</span> <span class="nf">bcdToDec</span><span class="p">(</span><span class="n">byte</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">return</span><span class="p">(</span> <span class="p">(</span><span class="n">val</span><span class="o">/</span><span class="mi">16</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">val</span><span class="o">%</span><span class="mi">16</span><span class="p">)</span> <span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// start I2C on pins 4 and 15</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">15</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
  <span class="c1">// set the initial time here:</span>
  <span class="c1">// DS3231 seconds, minutes, hours, day, date, month, year</span>
  <span class="c1">// setDS3231time(20,11,18,7,24,10,20);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">setDS3231time</span><span class="p">(</span><span class="n">byte</span> <span class="n">second</span><span class="p">,</span> <span class="n">byte</span> <span class="n">minute</span><span class="p">,</span> <span class="n">byte</span> <span class="n">hour</span><span class="p">,</span> <span class="n">byte</span> <span class="n">dayOfWeek</span><span class="p">,</span> <span class="n">byte</span>
<span class="n">dayOfMonth</span><span class="p">,</span> <span class="n">byte</span> <span class="n">month</span><span class="p">,</span> <span class="n">byte</span> <span class="n">year</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// sets time and date data to DS3231</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">beginTransmission</span><span class="p">(</span><span class="n">DS3231_I2C_ADDRESS</span><span class="p">);</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">// set next input to start at the seconds register</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">decToBcd</span><span class="p">(</span><span class="n">second</span><span class="p">));</span> <span class="c1">// set seconds</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">decToBcd</span><span class="p">(</span><span class="n">minute</span><span class="p">));</span> <span class="c1">// set minutes</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">decToBcd</span><span class="p">(</span><span class="n">hour</span><span class="p">));</span> <span class="c1">// set hours</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">decToBcd</span><span class="p">(</span><span class="n">dayOfWeek</span><span class="p">));</span> <span class="c1">// set day of week (1=Sunday, 7=Saturday)</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">decToBcd</span><span class="p">(</span><span class="n">dayOfMonth</span><span class="p">));</span> <span class="c1">// set date (1 to 31)</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">decToBcd</span><span class="p">(</span><span class="n">month</span><span class="p">));</span> <span class="c1">// set month</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">decToBcd</span><span class="p">(</span><span class="n">year</span><span class="p">));</span> <span class="c1">// set year (0 to 99)</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">endTransmission</span><span class="p">();</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">readDS3231time</span><span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="n">second</span><span class="p">,</span>
<span class="n">byte</span> <span class="o">*</span><span class="n">minute</span><span class="p">,</span>
<span class="n">byte</span> <span class="o">*</span><span class="n">hour</span><span class="p">,</span>
<span class="n">byte</span> <span class="o">*</span><span class="n">dayOfWeek</span><span class="p">,</span>
<span class="n">byte</span> <span class="o">*</span><span class="n">dayOfMonth</span><span class="p">,</span>
<span class="n">byte</span> <span class="o">*</span><span class="n">month</span><span class="p">,</span>
<span class="n">byte</span> <span class="o">*</span><span class="n">year</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">beginTransmission</span><span class="p">(</span><span class="n">DS3231_I2C_ADDRESS</span><span class="p">);</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">// set DS3231 register pointer to 00h</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">endTransmission</span><span class="p">();</span>
  <span class="n">Wire</span><span class="p">.</span><span class="n">requestFrom</span><span class="p">(</span><span class="n">DS3231_I2C_ADDRESS</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
  <span class="c1">// request seven bytes of data from DS3231 starting from register 00h</span>
  <span class="o">*</span><span class="n">second</span> <span class="o">=</span> <span class="n">bcdToDec</span><span class="p">(</span><span class="n">Wire</span><span class="p">.</span><span class="n">read</span><span class="p">()</span> <span class="o">&amp;</span> <span class="mh">0x7f</span><span class="p">);</span>
  <span class="o">*</span><span class="n">minute</span> <span class="o">=</span> <span class="n">bcdToDec</span><span class="p">(</span><span class="n">Wire</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>
  <span class="o">*</span><span class="n">hour</span> <span class="o">=</span> <span class="n">bcdToDec</span><span class="p">(</span><span class="n">Wire</span><span class="p">.</span><span class="n">read</span><span class="p">()</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">);</span>
  <span class="o">*</span><span class="n">dayOfWeek</span> <span class="o">=</span> <span class="n">bcdToDec</span><span class="p">(</span><span class="n">Wire</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>
  <span class="o">*</span><span class="n">dayOfMonth</span> <span class="o">=</span> <span class="n">bcdToDec</span><span class="p">(</span><span class="n">Wire</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>
  <span class="o">*</span><span class="n">month</span> <span class="o">=</span> <span class="n">bcdToDec</span><span class="p">(</span><span class="n">Wire</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>
  <span class="o">*</span><span class="n">year</span> <span class="o">=</span> <span class="n">bcdToDec</span><span class="p">(</span><span class="n">Wire</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">displayTime</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">byte</span> <span class="n">second</span><span class="p">,</span> <span class="n">minute</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">dayOfWeek</span><span class="p">,</span> <span class="n">dayOfMonth</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">year</span><span class="p">;</span>
  <span class="c1">// retrieve data from DS3231</span>
  <span class="n">readDS3231time</span><span class="p">(</span><span class="o">&amp;</span><span class="n">second</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">minute</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">hour</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dayOfWeek</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dayOfMonth</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">month</span><span class="p">,</span>
  <span class="o">&amp;</span><span class="n">year</span><span class="p">);</span>
  <span class="c1">// send it to the serial monitor</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">hour</span><span class="p">,</span> <span class="n">DEC</span><span class="p">);</span>
  <span class="c1">// convert the byte variable to a decimal number when displayed</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">minute</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">minute</span><span class="p">,</span> <span class="n">DEC</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">second</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">second</span><span class="p">,</span> <span class="n">DEC</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">dayOfMonth</span><span class="p">,</span> <span class="n">DEC</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">month</span><span class="p">,</span> <span class="n">DEC</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">DEC</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot; Day of week: &quot;</span><span class="p">);</span>
  <span class="k">switch</span><span class="p">(</span><span class="n">dayOfWeek</span><span class="p">){</span>
  <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Sunday&quot;</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Monday&quot;</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">3</span><span class="o">:</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Tuesday&quot;</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">4</span><span class="o">:</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Wednesday&quot;</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">5</span><span class="o">:</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Thursday&quot;</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">6</span><span class="o">:</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Friday&quot;</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="k">case</span> <span class="mi">7</span><span class="o">:</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Saturday&quot;</span><span class="p">);</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">displayTime</span><span class="p">();</span> <span class="c1">// display the real-time clock data on the Serial Monitor,</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="c1">// every second</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        <!--
  Copyright (c) 2016-2020 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->


<footer class="md-footer">
  
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
        <script src="../../../../javascripts/extra.js"></script>
      
    
  </body>
</html>